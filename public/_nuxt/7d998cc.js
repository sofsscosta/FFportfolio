(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{303:function(e,t,r){"use strict";r.r(t);r(49),r(64),r(37),r(65);var n=r(33),o=r(5),l=(r(22),r(36),r(52),r(81),r(16),r(25),r(26),r(53),r(41),r(48),r(140),r(47),r(138),r(66),r(3)),c=r(14),d=(r(139),r(265),r(15));function m(object,e){var t=Object.keys(object);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(object);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(object,e).enumerable}))),t.push.apply(t,r)}return t}function f(e){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?m(Object(source),!0).forEach((function(t){Object(n.a)(e,t,source[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(source)):m(Object(source)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(source,t))}))}return e}var h=l.a.extend({layout:"admin",data:function(){return{project:{date:"",description:"",images:[],images_preview:[],slug:"",subtitle:"",title:"",tags:[]},section:"",isLoading:!1}},fetch:function(){(!this.$route.query.section||this.$route.query.section instanceof Array)&&this.$router.push("/only-ferran-knows-221/error"),this.section=this.$route.query.section},methods:{createProject:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n,o,l,m;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,t.isLoading=!0,n={date:e.date,description:e.description,slug:t.generateSlug(e.title),subtitle:e.subtitle,title:e.title,tags:t.processTags(e.tags)},r.next=5,c.default.firestore().collection(t.section).add(n);case 5:return o=r.sent,r.next=8,t.uploadImages(e.images_preview);case 8:return l=r.sent,r.next=11,t.uploadImages(e.images);case 11:return m=r.sent,r.next=14,c.default.firestore().collection(t.section).doc(o.id).update(f(f({},n),{},{images_preview:l,images:m,id:o.id}));case 14:t.isLoading=!1,t.$store.dispatch("feedback",d.a.SUCCESS),t.$router.push("/only-ferran-knows-221/".concat(t.section,"/").concat(o.id)),r.next=23;break;case 19:r.prev=19,r.t0=r.catch(0),t.isLoading=!1,t.$store.dispatch("feedback",d.a.ERROR);case 23:case"end":return r.stop()}}),r,null,[[0,19]])})))()},uploadImages:function(e){var t=this;return Object(o.a)(regeneratorRuntime.mark((function r(){var n;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,n=[],r.next=4,Promise.all(e.map((function(element){return new Promise((function(e,r){var l,d,image=null===(d=null===(l=element.image)||void 0===l?void 0:l.files[0])||void 0===d?void 0:d.file;if(image){var m=c.default.storage().ref("/images/".concat(t.section,"/").concat(t.project.title,"/").concat(image.name)).put(image);m.on("state_changed",null,null,Object(o.a)(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.snapshot.ref.getDownloadURL();case 2:r=t.sent,n.push(r),e(r);case 5:case"end":return t.stop()}}),t)}))))}}))})));case 4:return r.abrupt("return",n);case 7:r.prev=7,r.t0=r.catch(0),console.log(r.t0);case 10:case"end":return r.stop()}}),r,null,[[0,7]])})))()},processTags:function(e){return e.filter((function(e){return e.tag})).map((function(e){return e.tag}))},generateSlug:function(title){return"/".concat(this.section,"/").concat(title.replace(/[^a-zA-Z0-9 ]/g,"").toLowerCase().split(" ").join("-"))}}}),v=r(11),component=Object(v.a)(h,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"font-light text-gray-500 mb-20 flex flex-col w-full items-center"},[r("p",{staticClass:"text-5xl mt-10 mb-12 font-thin"},[e._v("New "),r("span",{staticClass:"font-light"},[e._v(e._s(e.section.toUpperCase()))]),e._v(" project")]),e._v(" "),r("FormulateForm",{staticClass:"max-w-2xl",on:{submit:e.createProject},model:{value:e.project,callback:function(t){e.project=t},expression:"project"}},[r("FormulateInput",{attrs:{type:"text",label:"Title",name:"title",placeholder:"Title",validation:"required"}}),e._v(" "),r("FormulateInput",{attrs:{type:"text",label:"Subtitle",name:"subtitle",placeholder:"Subtitle"}}),e._v(" "),r("FormulateInput",{attrs:{type:"textarea",label:"Description",name:"description",placeholder:"Description","input-class":"h-56"}}),e._v(" "),r("FormulateInput",{attrs:{type:"text",label:"Date",name:"date",help:"Please inser the date manually in the format you'd like to see displayed. Ex: Aug 2021 or 08/2021",placeholder:"Date"}}),e._v(" "),r("FormulateInput",{attrs:{type:"group",repeatable:!0,name:"images_preview",label:"Preview images",help:"Introduce them in order of display. These will be the 3 images the user sees before entering the project's details.",validation:"required","add-label":"+ Add image"}},[r("FormulateInput",{attrs:{type:"image",name:"image",validation:"mime:image/jpeg,image/png,image/gif"}})],1),e._v(" "),r("FormulateInput",{attrs:{type:"group",repeatable:!0,name:"images",label:"Images",help:"Introduce them in order of display. These will be all the images inside the project's details.",validation:"required","add-label":"+ Add image"}},[r("FormulateInput",{attrs:{type:"image",name:"image",validation:"mime:image/jpeg,image/png,image/gif"}})],1),e._v(" "),r("FormulateInput",{attrs:{type:"group",name:"tags",repeatable:!0,label:"Tags","add-label":"+ Add tag",validation:"max:3"}},[r("FormulateInput",{attrs:{name:"tag",label:"Tag"}})],1),e._v(" "),r("FormulateInput",{staticClass:"mt-10",attrs:{type:"submit",label:e.isLoading?"LOADING...":"CREATE PROJECT",disabled:e.isLoading}})],1)],1)}),[],!1,null,null,null);t.default=component.exports}}]);