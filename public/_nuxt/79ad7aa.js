(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{306:function(e,t,r){"use strict";r.r(t);var n=r(5),c=(r(16),r(25),r(26),r(53),r(192),r(47),r(138),r(81),r(22),r(3)),o=r(14),l=r(42),v=r(15),d=c.a.extend({layout:"admin",data:function(){return{reviews:[]}},fetch:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("fetchReviews");case 2:e.reviews=e.$store.state.reviews,e.addReviewProject();case 4:case"end":return t.stop()}}),t)})))()},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.reviews=e.$store.state.reviews,e.addReviewProject();case 2:case"end":return t.stop()}}),t)})))()},methods:{handleDelete:function(e,t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,window.confirm("Are you sure you want to delete review by ".concat(e,"?"))){n.next=4;break}return n.abrupt("return");case 4:return n.next=6,o.default.firestore().collection("reviews").doc(t).delete();case 6:return n.next=8,r.$store.dispatch("fetchReviews");case 8:r.reviews=r.$store.state.reviews,r.addReviewProject(),r.$store.dispatch("feedback",v.a.SUCCESS),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(0),r.$store.dispatch("feedback",v.a.ERROR);case 16:case"end":return n.stop()}}),n,null,[[0,13]])})))()},truncate:l.c,addReviewProject:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Promise.all(e.$store.state.reviews.map(function(){var e=Object(n.a)(regeneratorRuntime.mark((function e(t){var r,n,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.link){e.next=2;break}return e.abrupt("return",t);case 2:return r=t.link.split("/")[1],e.next=5,o.default.firestore().collection(r).where("slug","==",t.link).get();case 5:if(n=e.sent,c=n.docs[0].data()){e.next=9;break}return e.abrupt("return",t);case 9:if(n.docs[0].id){e.next=11;break}return e.abrupt("return",t);case 11:return l={slug:"/".concat(r,"/").concat(n.docs[0].id),title:c.title},t.project=l,e.abrupt("return",t);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 3:e.reviews=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),e.$store.dispatch("feedback",v.a.ERROR);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()}}}),f=d,w=r(11),component=Object(w.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"font-light text-gray-500"},[r("h2",{staticClass:"text-3xl mt-14 mb-3 font-thin"},[e._v("REVIEWS")]),e._v(" "),r("h2",{staticClass:"font-light mb-10"},[e._v("\n        Here you can create, edit or delete reviews. Click on each item to see its details.\n    ")]),e._v(" "),r("client-only",[e.$store.state.reviews.length?r("ul",{key:e.$store.state.reviews&&e.$store.state.reviews.length,staticClass:"mb-20 w-full px-10"},[r("div",{staticClass:"flex flex-row justify-between text-lg"},[r("p",[e._v("Author")]),e._v(" "),r("p",[e._v("Text")]),e._v(" "),r("p",[e._v("See related project")]),e._v(" "),r("p",[e._v("Actions")])]),e._v(" "),r("hr"),e._v(" "),e._l(e.reviews,(function(t,n){return r("li",{key:n},[r("client-only",[t?r("div",{staticClass:"flex flex-row justify-between items-center py-5"},[t&&t.id?r("nuxt-link",{attrs:{to:"/only-ferran-knows-221/reviews/edit/"+t.id}},[r("p",[e._v(e._s(t.author))])]):e._e(),e._v(" "),t.text?r("p",[e._v(e._s(e.truncate(t.text,30)))]):e._e(),e._v(" "),t.link?r("nuxt-link",{key:!!t.project+" "+n,staticClass:"flex items-center",attrs:{to:"/only-ferran-knows-221"+(t.project&&t.project.slug)}},[r("p",{staticClass:"bg-gray-200 rounded-full px-3 py-2 w-min min-w-max"},[e._v(e._s(t.project&&t.project.title))])]):r("div"),e._v(" "),r("div",[r("button",{on:{click:function(r){return r.target!==r.currentTarget?null:e.handleDelete(t.title,t.id||0)}}},[e._v("Delete")])])],1):e._e(),e._v(" "),r("hr")])],1)}))],2):e._e()]),e._v(" "),r("nuxt-link",{attrs:{to:"/only-ferran-knows-221/reviews/create",name:"Add"}},[r("p",{staticClass:"bg-gray-400 rounded-full px-3 py-2 text-white w-min min-w-max mb-8"},[e._v("Add review")])]),e._v(" "),r("label",{attrs:{for:"Add"}},[e._v("NOTE: this review will have no project associated. To create a review for a project please got to the section that project belongs to.")])],1)}),[],!1,null,null,null);t.default=component.exports}}]);